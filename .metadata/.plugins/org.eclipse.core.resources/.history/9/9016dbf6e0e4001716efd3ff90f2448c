package homeAutomation;

import java.util.ArrayList;

public class HAManager {

	//  ATRIBUTES
	ArrayList<Component> components = new ArrayList<>();
	ArrayList<Automation> automations = new ArrayList<>();

	// CONSTRUCTOR
	public HAManager(){
	}

	// METHODS
	public ArrayList<Component> getComponents(){
		return components;
	}
	public ArrayList<Automation> getAutomations(){
		return automations;
	}

	/**
	 * Creates a new automation, linking two components.
	 * When a status change of a component is defined as a trigger in an automation
	 * the status of the response Component will be changed to <code>responseStatus</code>
	 * @param name the name of the automation
	 * @param triggerComp the Component which triggers the automation
	 * @param triggerStatus the prerequisite status of <code>triggerComp</code> to trigger the automation
	 * @param responseComp the Component which responses to the trigger
	 * @param responseStatus the wanted status of <code>responseComp</code>
	 */
	public void createNewAutomation(String name, Component triggerComp, boolean triggerStatus, Component responseComp, boolean responseStatus){
		Automation newAutomation = new Automation(name, triggerComp, triggerStatus, responseComp, responseStatus);
		automations.add(newAutomation);
	}

	public void createNewComponent(String name){
		for (Component c : components){ //see if component does not exist yet
			if (!c.getName().equals(name)){
				Component newComponent = new Component(name);
				components.add(newComponent);
			}
	}

	public void changeStatus(String name, boolean stat){
		for (Component c : components){ // find the component
			if (c.getName().equals(name) && c.getStatus() != stat) { //if current status is not stat
				c.changeStatus(stat); //change status

					for (Automation a: automations){ // search automations with triggerComp == c
						if (a.getTriggerComp() == c && a.getTriggerStatus() == stat){ //and triggerStatus==stat
							a.getRespComp().changeStatus(a.getRespStatus()); // set new responseStatus to responseComp
						}
					} //end second forloop
			} //end first if
		} //end first forloop
	} // endmethod changeStatus


}
